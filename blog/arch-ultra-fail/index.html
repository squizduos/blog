<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=generator content="Hugo 0.59.1"><title>Почти история успеха: как поставить Арч и всё потерять &middot; Squizduos Slowblog</title><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css><!--[if lte IE 8]><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css><![endif]--><!--[if gt IE 8]><!--><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css><!--<![endif]--><!--[if lte IE 8]><link rel=stylesheet href=https://squizduos.github.io/blog/css/side-menu-old-ie.css><![endif]--><!--[if gt IE 8]><!--><link rel=stylesheet href=https://squizduos.github.io/blog/css/side-menu.css><!--<![endif]--><link rel=stylesheet href=https://squizduos.github.io/blog/css/blackburn.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.8.2/css/all.css integrity=sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay crossorigin=anonymous><link href="https://fonts.googleapis.com/css?family=Raleway" rel=stylesheet type=text/css><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><link rel=alternate type=application/rss+xml title="Squizduos Slowblog" href=https://squizduos.github.io/blog/index.xml><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script><link rel="shortcut icon" href=https://squizduos.github.io/blog/img/favicon.ico type=image/x-icon></head><body><div id=layout><a href=#menu id=menuLink class=menu-link><span></span></a><div id=menu><a class="pure-menu-heading brand" href=https://squizduos.github.io/blog/>Squizduos Slowblog</a><div class=pure-menu><ul class=pure-menu-list><li class=pure-menu-item><p class=pure-menu-title>Филиалы</p></li><li class=pure-menu-item><a class=pure-menu-link href=https://tlg.name/ch_11><i class="fab fa-telegram fa-fw"></i>Channel 11</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://twitter.com/squizduos><i class="fab fa-twitter-square fa-fw"></i>Nova the Hedgehog</a></li></ul></div><div class="pure-menu social"><ul class=pure-menu-list><li class=pure-menu-item><p class=pure-menu-title>Контакты</p></li><li class=pure-menu-item><a class=pure-menu-link href=https://vk.com/squizduos target=_blank><i class="fab fa-vk fa-fw"></i>ВКонтакте</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://linkedin.com/in/squizduos target=_blank><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://github.com/squizduos target=_blank><i class="fab fa-github-square fa-fw"></i>GitHub</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://bitbucket.org/squizduos target=_blank><i class="fab fa-bitbucket fa-fw"></i>Bitbucket</a></li></ul></div><div class=pure-menu><ul class=pure-menu-list><li class=pure-menu-item><p class=pure-menu-title>Темы</p></li><li class=pure-menu-item><a class=pure-menu-link href=https://squizduos.github.io/blog/topics/%D0%BE%D0%B1%D0%B7%D0%BE%D1%80%D1%8B/>Обзоры (8)</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://squizduos.github.io/blog/topics/%D0%BA%D0%BD%D0%B8%D0%B3%D0%B8/>Книги (5)</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://squizduos.github.io/blog/topics/linux/>Linux (3)</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://squizduos.github.io/blog/topics/%D0%B8%D0%BD%D0%BD%D0%BE%D0%BF%D0%BE%D0%BB%D0%B8%D1%81/>Иннополис (3)</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://squizduos.github.io/blog/topics/%D0%B0%D0%BD%D0%B8%D0%BC%D0%B5/>Аниме (1)</a></li><i><a class=pure-menu-link href=https://squizduos.github.io/blog/topics>Остальные (8)</a></i></ul></div><div id=copyright><div class=small-print><small>&copy; 2022 &nbsp; Semyon Bochkaryov</small></div><div class=small-print><table cellpadding=10><tbody><tr><td><small>Built with: &nbsp;</small></td><td><small><a style=padding:0 href=https://gohugo.io/>Hugo</a> v.0.59.1</small></td></tr><tr><td><small>Last updated: &nbsp;</small></td><td><small>19.01.2022</small></td></tr><tr><td><small>Theme: &nbsp;</small></td><td><small><a style=padding:0 href=https://github.com/yoshiharuyamashita/blackburn target=_blank>Blackburn</a> mod</small></td></tr></tbody></table></div></div></div><div id=main><div class=header><h1>Почти история успеха: как поставить Арч и всё потерять</h1><h2></h2><nav class=site-nav><a class=page-link href=https://squizduos.github.io/blog/><i class="fa fa-home fa-fw"></i>Главная</a>
<a class=page-link href=https://squizduos.github.io/blog/projects/><i class="fa fa-desktop fa-fw"></i>Проекты</a>
<a class=page-link href=https://squizduos.github.io/blog/about/><i class="fa fa-phone fa-fw"></i>О блоге</a>
<a class=page-link href=https://squizduos.github.io/blog/index.xml><i class="fa fa-rss fa-fw"></i>RSS</a></nav></div><div class=content><div class=post-meta><div style=display:inline-block;margin-top:20px;margin-right:30px><i class="fa fa-calendar fa-fw"></i><time>31.10.2014 12:40</time></div><div style=display:inline-block;margin-top:20px;margin-right:30px><i class="fa fa-user fa-fw"></i><span>Semyon Bochkaryov</span></div><div style=display:inline-block;margin-top:20px;margin-right:30px><i class="fa fa-folder fa-fw"></i><a class=post-taxonomy-topic href=https://squizduos.github.io/blog/topics/linux>Linux</a></div></div><p>Вообще, историю моих скитаний по линукс-дистрибутивам можно рассказывать долго, но я расскажу свежую и относительно весёлую: как я на Арч мигрировал.</p><h3 id=1-как-я-всё-потерял>1. Как я всё потерял</h3><p>Изначальной предпосылкой было то, что меня достал Crunchbang. Этот дистрибутив на базе Debian с Openbox на борту хорош всем, на самом деле, кроме одного: он построен на Debian Stable. Stable недаром зовётся стабильным - весь софт в нём не просто старый, а ОЧЕНЬ старый, и обновляться на актуальные версии не спешит. Как следствие, ни свежий MySQL Workbench поставить не получится, ни Steam, даже Iron Browser, собранный с свежим glibc, не запустится. В итоге я решил переехать на Debian Testing, заменил репозитории и обновился. Crunchbang развалился.</p><p>Точнее, развалилась их фирменная тема wardolf, поставляемая с дистрибутивом - да и многие GNOME-утилиты, поставляемые с дистрибутивом, стали выглядеть в стиле этого самого GNOME 3, что не очень приятно. В итоге, я поставил KDE, настроил его и успокоился - теперь это уже был не Crunchbang, а Debian Testing, и почти всё работало. Но дьявол - он в мелочах. Стандартные настройки Crunchbang явно конфликтовали с настройками Testing, в итоге, я получал очень весёлые глюки. Прошёл месяц, и это меня достало, я решил снова переустанавливать систему.</p><p>Выбор у меня был из двух <del>стульев</del> вариантов - либо ставить Debian Testing с нуля, либо поставить какой-то другой дистрибутив. Тут уже я вспомнил про Arch - невероятно удобный компактный линукс, у которого ещё и пакетный менеджер реактивный, и AUR (огромный репозиторий с сторонним софтом) присутствует, причём часто в нём есть софт, который нельзя найти ни в одном дистрибутиве (например, шрифты от Microsoft). Таким образом, решение было принято - ставим Арч. Вот тут и началось.</p><p>У меня в ноутбуке стоит два жёстких диска: стандартный SSD на 120 гигабайт с системой и софтом, и HDD на 500 гигабайт с фильмами, музыкой и данными. Первый обозначен в системе как /dev/sda, второй как /dev/sdb, флешка, на которую я записывал установочный образ Арча - /dev/sdd. Я перенёс все данные на второй жёсткий диск, скачал образ archlinux-2014.10.01.iso и набрал в консоли:</p><pre><code>dd if=archlinux-2014.10.01.iso of=/dev/sd**b**
</code></pre><p>Да, в этом была моя огромная ошибка, я по привычке набрал /dev/sdb (до покупки SSD там всегда была флешка), в итоге, я сломал файловую систему. Полностью. Исправлять было уже поздно, я кинулся за внешним HDD и начал копировать на него всё содержимое перезатёртого диска (оно, несмотря на зверскую экзекуцию, всё ещё читалось). Успел скопировать IT-книги и фильмы - потом до ОС дошло, что я только что натворил, и раздел перестал читаться.</p><p>Следующие 14 часов я всеми мыслимыми усилиями восстанавливал содержимое жёсткого диска. В ход пошёл R-Studio, R-Linux, ext4undelete, testdisk и прочие утилиты для восстановления данных - но восстановить ими почти ничего не удалось, файловая система была безнадёжно испорчена. Особенно жалко фотографии - у меня не осталось их резервной копии. Но отступать было уже поздно, и я со второй попытки я записал установочный образ Arch Linux на флэшку.</p><h3 id=2-как-я-установил-arch>2. Как я установил Arch</h3><p>С начала установки прошло уже 24 часа (начинал я ставить вечером среды, а к установке приступил в четверг вечером), и мелкий облом не заставил себя ждать - образ с арчем, который сейчас лежит на archlinux.org, не работает. Причина, если кратко - внутренний раздел с RootFS обозван ARCH_201410, как и сам диск, в итоге, система не может понять, какой из двух разделов ей монтировать и отказывается грузиться. Если надумаете ставить Арч - грузите лучше образ от 2014.09.03, он работает, а разницы в процессе установки нет.</p><figure style="padding:.25rem;margin:2rem 0;background-color:#cccc;text-align:center"><img style=max-width:100%;height:auto src=https://pbs.twimg.com/media/B1NTkJgIAAEmkzm.jpg:large width=800 height><figcaption><small></small></figcaption></figure><p>Далее установка проходит согласно <a href=https://wiki.archlinux.org/index.php/Installation_guide>этой</a> инструкции без особых проблем, и базовая система у вас уже стоит. Однако, я тут наткнулся на второй косяк - поскольку я хотел сразу систему с KDE, то я поставил полный пакет kde, но этот пакет не потянул за собой xorg-server! Как kde будет работать без xorg - вопрос актуальный. У меня не заработал - после загрузки установленной ОС остался наедине с чёрной консолью и даже без возможности доустановить пакеты (кстати, тут косяк №3 - если у вас Wi-Fi, обязательно поставьте пакет dialog при установке системы, иначе стандартный wifi-menu не заработает, а при отсутствующем NetworkManager или wicd - это единственная возможность поднять Wi-Fi из консоли.</p><p>После доустановки xorg-server и NetworkManager (кстати, не забудьте поставить их в автозагрузку - для этого надо набрать <em>systemctl enable kdm</em> и <em>systemctl enable NetworkManager</em>), жизнь становится куда веселее. Но не в моём случае - после установки я захотел скопировать спасённые данные обратно на жёсткий диск. Копирование прошло без проблем, но я решил заодно монтировать этот диск при загрузке и прописал его в fstab. Да, тот самый раздел, на котором 14 часов искались файлы. В итоге, при загрузке система начала проверять диск на ошибки, а я прошёл весёлый квест, заключающийся в бесперерывном нажатии кнопки Enter. Три часа подряд. В конце, я не выдержал и поставил отвёртку на клавишу - дело пошло куда веселее</p><figure style="padding:.25rem;margin:2rem 0;background-color:#cccc;text-align:center"><img style=max-width:100%;height:auto src=https://pbs.twimg.com/media/B1OevLdCAAAqkxN.jpg width=800 height><figcaption><small></small></figcaption></figure><p>Ещё через два часа проверка закончилась, и вот я пишу уже из Арча.</p><p>Какая мораль у этой истории? Их целых три: не меняйте ОС без особой нужды, делайте резервные копии важных файлов, читайте документацию перед установкой незнакомой ОС. Тогда вам не придётся сидеть над установкой 36 часов, как мне.</p><div class="prev-next-post pure-g"><div class=pure-u-1-24 style=text-align:left><a href=https://squizduos.github.io/blog/blog/focuswriter-review/><i class="fa fa-chevron-left"></i></a></div><div class=pure-u-10-24><nav class=prev><a href=https://squizduos.github.io/blog/blog/focuswriter-review/>FocusWriter: «блокнот» для настоящих ценителей</a></nav></div><div class=pure-u-2-24>&nbsp;</div><div class=pure-u-10-24><nav class=next><a href=https://squizduos.github.io/blog/blog/imitation-game/>Впечатления от Игры в Имитацию</a></nav></div><div class=pure-u-1-24 style=text-align:right><a href=https://squizduos.github.io/blog/blog/imitation-game/><i class="fa fa-chevron-right"></i></a></div></div><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")
return;var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='squizduos';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=http://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div><script src=https://squizduos.github.io/blog/js/ui.js></script><script src=https://squizduos.github.io/blog/js/menus.js></script><script>if(window.location.hostname!="localhost"){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-64612974-1','auto');ga('send','pageview');}</script></body></html>